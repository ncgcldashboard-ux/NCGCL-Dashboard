<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NCGCL HR Committee Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Custom scrollbar for tables */
        .overflow-x-auto::-webkit-scrollbar {
            height: 8px;
        }
        .overflow-x-auto::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .overflow-x-auto::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        .overflow-x-auto::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icons (Inline SVGs for standalone stability) ---
        const Icon = ({ children, size = 18, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );

        const Users = (props) => <Icon {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></Icon>;
        const Car = (props) => <Icon {...props}><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/><circle cx="7" cy="17" r="2"/><path d="M9 17h6"/><circle cx="17" cy="17" r="2"/></Icon>;
        const Wifi = (props) => <Icon {...props}><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><line x1="12" y1="20" x2="12.01" y2="20"/></Icon>;
        const Award = (props) => <Icon {...props}><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></Icon>;
        const ChevronRight = (props) => <Icon {...props}><polyline points="9 18 15 12 9 6"/></Icon>;
        const Calculator = (props) => <Icon {...props}><rect x="4" y="2" width="16" height="20" rx="2"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="16" y1="14" x2="16" y2="14"/><line x1="12" y1="14" x2="12" y2="14"/><line x1="8" y1="14" x2="8" y2="14"/><line x1="16" y1="18" x2="16" y2="18"/><line x1="12" y1="18" x2="12" y2="18"/><line x1="8" y1="18" x2="8" y2="18"/></Icon>;
        const FileText = (props) => <Icon {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></Icon>;
        const TrendingUp = (props) => <Icon {...props}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></Icon>;
        const DollarSign = (props) => <Icon {...props}><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></Icon>;
        const Info = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></Icon>;
        const CheckCircle = (props) => <Icon {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></Icon>;
        const AlertCircle = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></Icon>;

        // --- Data & Constants ---

        // Agenda 2: Car Monetization
        const monetizationData = [
            { grade: "10 (CEO)", role: "Chief Executive", refCar2025: "Honda Civic RS 1.6", price2025: 9899000, allow2025: 216652, refCar2026: "Honda Civic RS 1.6", price2026: 10578348, allow2026: 219556, increase: 2904, pct: 1.3 },
            { grade: "9", role: "Managing Director", refCar2025: "Toyota Corolla Altis 1.6 Auto", price2025: 6559000, allow2025: 143552, refCar2026: "Toyota Corolla Altis 1.6 Auto", price2026: 7040631, allow2026: 146130, increase: 2578, pct: 1.8 },
            { grade: "8", role: "Director", refCar2025: "Honda City 1.5 Auto", price2025: 5439000, allow2025: 119039, refCar2026: "Honda City 1.5 Auto", price2026: 6369002, allow2026: 132190, increase: 13151, pct: 11.0 },
            { grade: "7", role: "Senior Manager", refCar2025: "Suzuki Cultus", price2025: 3858000, allow2025: 84437, refCar2026: "Toyota Yaris CVT 1.3", price2026: 5071572, allow2026: 105262, increase: 20825, pct: 24.7 },
            { grade: "6", role: "Manager", refCar2025: "Suzuki Wagon R", price2025: 3214000, allow2025: 70342, refCar2026: "Kia Picanto", price2026: 4206359, allow2026: 87304, increase: 16962, pct: 24.1 },
        ];

        // Agenda 3: Communication Allowance
        const commData = [
            { grade: "10", role: "CEO", current: "On actual", proposed: "On actual", change: 0 },
            { grade: "9", role: "Managing Director", current: "10,000", proposed: "12,000", change: 2000 },
            { grade: "8", role: "Director", current: "10,000", proposed: "11,000", change: 1000 },
            { grade: "7", role: "Senior Manager", current: "5,000", proposed: "9,500", change: 4500 },
            { grade: "6", role: "Manager", current: "4,500", proposed: "9,000", change: 4500 },
            { grade: "5", role: "Assistant Manager", current: "3,500", proposed: "8,500", change: 5000 },
            { grade: "4", role: "Mgmt Trainee", current: "2,000", proposed: "8,000", change: 6000 },
            { grade: "3", role: "Admin Assistant", current: "2,500", proposed: "2,500", change: 0 },
            { grade: "2", role: "Office Boy/Driver", current: "1,000", proposed: "1,500", change: 500 },
            { grade: "1", role: "Janitorial Staff", current: "1,000", proposed: "1,500", change: 500 },
        ];
        
        // Agenda 3: Internet Market Data (Annex 1)
        const internetMarketData = [
            { provider: "PTCL Flash Fiber", speed: "50 Mbps", base: 5864, total: 7799 },
            { provider: "Optix Hyperboost", speed: "50 Mbps", base: 5799, total: 7713 },
            { provider: "StormFiber Thunder", speed: "55 Mbps", base: 5299, total: 7048 },
            { provider: "Nayatel Unlimited", speed: "50 Mbps", base: 5250, total: 6982 },
            { provider: "Transworld", speed: "50 Mbps", base: 5000, total: 6650 },
        ];

        // Agenda 4: Vehicle Policy (Entitlements)
        const vehicleEntitlements = [
            { grade: "10", car: "Honda Civic RS 1.6", value: 10578348 },
            { grade: "9", car: "Toyota Corolla Altis 1.6 Auto", value: 7040631 },
            { grade: "8", car: "Honda City 1.5 Auto", value: 6369002 },
            { grade: "7", car: "Toyota Yaris CVT 1.3", value: 5071572 },
            { grade: "6", car: "Kia Picanto", value: 4206359 },
        ];

        // Agenda 5: FYRA Grade Multipliers
        const fyraMultipliers = {
            "10": 1.30,
            "9": 1.20,
            "8": 1.20,
            "7": 1.00,
            "6": 1.00,
            "5": 0.95,
            "4": 0.90, 
            "3": 0.90,
            "2": 0.90,
            "1": 0.90
        };

        const performanceOverlay = {
            "Solid": 0.9,
            "Strong": 1.0,
            "Exceptional": 1.1
        };

        // --- Components ---

        const Card = ({ children, className = "" }) => (
            <div className={`bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden ${className}`}>
                {children}
            </div>
        );

        const Badge = ({ children, color = "blue" }) => {
            const colors = {
                blue: "bg-blue-100 text-blue-800",
                green: "bg-emerald-100 text-emerald-800",
                amber: "bg-amber-100 text-amber-800",
                purple: "bg-purple-100 text-purple-800",
                slate: "bg-slate-100 text-slate-800",
                emerald: "bg-emerald-100 text-emerald-800"
            };
            return (
                <span className={`px-2.5 py-0.5 rounded-full text-xs font-medium ${colors[color] || colors.blue}`}>
                {children}
                </span>
            );
        };

        // --- Main App Component ---

        function BoardDashboard() {
            const [activeTab, setActiveTab] = useState("home");
            const [isSidebarOpen, setSidebarOpen] = useState(true);

            // --- Calculator States ---
            // Agenda 4 Calc
            const [vGrade, setVGrade] = useState("7");
            const [chosenCarPrice, setChosenCarPrice] = useState(5500000);
            const [earlyExitMonths, setEarlyExitMonths] = useState(24);

            // Agenda 5 Calc
            const [fyraGrade, setFyraGrade] = useState("7");
            const [annualBase, setAnnualBase] = useState(3000000);
            const [serviceMonths, setServiceMonths] = useState(12);
            const [perfRating, setPerfRating] = useState("Strong");
            
            const [hypotheticalCTAR, setHypotheticalCTAR] = useState(0.05); // 5% of weighted base

            // --- Helpers ---
            const formatCurrency = (val) => new Intl.NumberFormat('en-PK', { style: 'currency', currency: 'PKR', maximumFractionDigits: 0 }).format(val);
            
            const NavItem = ({ id, label, icon: Icon, color }) => {
                const activeClasses = {
                    blue: "bg-blue-50 text-blue-700 border-blue-600",
                    emerald: "bg-emerald-50 text-emerald-700 border-emerald-600",
                    purple: "bg-purple-50 text-purple-700 border-purple-600",
                    amber: "bg-amber-50 text-amber-700 border-amber-600",
                    slate: "bg-slate-50 text-slate-700 border-slate-600"
                };

                return (
                    <button 
                        onClick={() => setActiveTab(id)}
                        className={`w-full flex items-center gap-3 px-4 py-3 text-sm font-medium transition-colors border-l-4 ${
                        activeTab === id 
                            ? activeClasses[color] || activeClasses.slate
                            : "text-slate-600 hover:bg-slate-50 border-transparent"
                        }`}
                    >
                        <Icon size={18} />
                        <span>{label}</span>
                    </button>
                );
            };

            // --- Renders for each Tab ---

            const renderHome = () => {
                const iconColors = {
                    blue: "bg-blue-100 text-blue-600",
                    emerald: "bg-emerald-100 text-emerald-600",
                    purple: "bg-purple-100 text-purple-600",
                    amber: "bg-amber-100 text-amber-600"
                };

                return (
                <div className="space-y-6 animate-in fade-in duration-500">
                    <div className="bg-gradient-to-r from-slate-900 to-slate-800 p-8 rounded-2xl text-white shadow-lg">
                    <h1 className="text-3xl font-bold mb-2">HR Committee Meeting Dashboard</h1>
                    <p className="text-slate-300 max-w-2xl">
                        Welcome to the interactive board pack. This dashboard consolidates financial impact analyses, 
                        policy changes, and interactive models for the upcoming NCGCL HR Committee meeting.
                    </p>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    {[
                        { title: "Agenda 2", sub: "Car Monetization", desc: "Indexation for FY26", icon: Car, color: "blue", id: "agenda2" },
                        { title: "Agenda 3", sub: "Comm. Allowance", desc: "Policy Revision & Tax Adj.", icon: Wifi, color: "emerald", id: "agenda3" },
                        { title: "Agenda 4", sub: "Vehicle Policy", desc: "Company Car & Buyback", icon: FileText, color: "purple", id: "agenda4" },
                        { title: "Agenda 5", sub: "FYRA Award", desc: "Founding Year Recognition", icon: Award, color: "amber", id: "agenda5" },
                    ].map((item) => {
                        const IconComp = item.icon;
                        return (
                        <button 
                            key={item.id}
                            onClick={() => setActiveTab(item.id)}
                            className="group text-left bg-white p-6 rounded-xl border border-slate-200 hover:shadow-md transition-all hover:border-blue-300 w-full"
                        >
                            <div className={`w-12 h-12 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform ${iconColors[item.color]}`}>
                                <IconComp size={24} />
                            </div>
                            <h3 className="font-semibold text-slate-900">{item.title}</h3>
                            <div className="text-sm font-medium text-slate-700">{item.sub}</div>
                            <p className="text-xs text-slate-500 mt-1">{item.desc}</p>
                        </button>
                    )})}
                    </div>
                </div>
                );
            };

            const renderAgenda2 = () => (
                <div className="space-y-6">
                <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                    <h2 className="text-2xl font-bold text-slate-900">Agenda 2: Car Monetization Indexation</h2>
                    <p className="text-slate-500">Update for FY2026 based on market variables as of Dec 12, 2025.</p>
                    </div>
                    <Badge color="blue">For Approval</Badge>
                </div>

                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div className="lg:col-span-2 space-y-6">
                    <Card className="p-0">
                        <div className="bg-slate-50 px-6 py-4 border-b border-slate-200 font-semibold text-slate-700">
                        Grade-wise Indexation Analysis
                        </div>
                        <div className="overflow-x-auto">
                        <table className="w-full text-sm text-left">
                            <thead className="bg-slate-50 text-slate-500 font-medium">
                            <tr>
                                <th className="px-6 py-3">Grade</th>
                                <th className="px-6 py-3">2026 Reference Car</th>
                                <th className="px-6 py-3 text-right">Car Price</th>
                                <th className="px-6 py-3 text-right">New Allowance</th>
                                <th className="px-6 py-3 text-right">Increase</th>
                            </tr>
                            </thead>
                            <tbody className="divide-y divide-slate-100">
                            {monetizationData.map((row, i) => (
                                <tr key={i} className="hover:bg-slate-50">
                                <td className="px-6 py-4 font-medium text-slate-900">{row.grade}</td>
                                <td className="px-6 py-4 text-slate-600">{row.refCar2026}</td>
                                <td className="px-6 py-4 text-right text-slate-600">{formatCurrency(row.price2026)}</td>
                                <td className="px-6 py-4 text-right font-bold text-blue-700">{formatCurrency(row.allow2026)}</td>
                                <td className="px-6 py-4 text-right text-emerald-600 flex items-center justify-end gap-1">
                                    <TrendingUp size={14} />
                                    {row.pct.toFixed(1)}%
                                </td>
                                </tr>
                            ))}
                            </tbody>
                        </table>
                        </div>
                    </Card>
                    </div>

                    <div className="space-y-6">
                    <Card className="p-6 bg-blue-50 border-blue-100">
                        <h3 className="font-semibold text-blue-900 mb-3 flex items-center gap-2">
                        <Info size={18} />
                        Key Insights
                        </h3>
                        <ul className="space-y-3 text-sm text-blue-800">
                        <li className="flex gap-2 items-start">
                            <span className="mt-1 w-1.5 h-1.5 rounded-full bg-blue-500 shrink-0" />
                            <span><strong>Interest Rate Drop:</strong> Rates fell from 16.0% (2025) to 13.6% (2026), mitigating the impact of rising car prices on the monthly allowance.</span>
                        </li>
                        <li className="flex gap-2 items-start">
                            <span className="mt-1 w-1.5 h-1.5 rounded-full bg-blue-500 shrink-0" />
                            <span><strong>Impact:</strong> Modest increase (1.3% - 1.8%) for senior grades (10-9). Higher impact (~24%) for middle management due to significant price jumps in the Yaris/Picanto segment.</span>
                        </li>
                        </ul>
                    </Card>

                    <Card className="p-6">
                        <h3 className="font-semibold text-slate-900 mb-4">Effective Date</h3>
                        <div className="flex items-center gap-4 p-4 bg-slate-100 rounded-lg">
                        <div className="bg-white p-2 rounded shadow-sm font-bold text-slate-800">01</div>
                        <div className="bg-white p-2 rounded shadow-sm font-bold text-slate-800">JAN</div>
                        <div className="bg-white p-2 rounded shadow-sm font-bold text-slate-800">2026</div>
                        </div>
                        <p className="text-xs text-slate-500 mt-2">
                        Proposed resolution is to approve indexation w.e.f Jan 1, 2026.
                        </p>
                    </Card>
                    </div>
                </div>
                </div>
            );

            const renderAgenda3 = () => (
                <div className="space-y-6">
                <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                    <h2 className="text-2xl font-bold text-slate-900">Agenda 3: Communication Allowance Policy</h2>
                    <p className="text-slate-500">Recalibration for hybrid work environment & tax-inclusive costs.</p>
                    </div>
                    <Badge color="emerald">For Approval</Badge>
                </div>

                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div className="lg:col-span-2 space-y-6">
                        {/* Allowance Table */}
                        <Card className="p-0">
                            <div className="bg-slate-50 px-6 py-4 border-b border-slate-200 font-semibold text-slate-700 flex justify-between items-center">
                            <span>Current vs. Proposed Allowance</span>
                            <span className="text-xs font-normal bg-white px-2 py-1 rounded border border-slate-200 text-slate-500">PKR / Month</span>
                            </div>
                            <div className="overflow-x-auto max-h-[500px]">
                            <table className="w-full text-sm text-left">
                                <thead className="bg-slate-50 text-slate-500 font-medium sticky top-0">
                                <tr>
                                    <th className="px-6 py-3">Grade</th>
                                    <th className="px-6 py-3">Current</th>
                                    <th className="px-6 py-3">Proposed</th>
                                    <th className="px-6 py-3 text-right">Net Increase</th>
                                </tr>
                                </thead>
                                <tbody className="divide-y divide-slate-100">
                                {commData.map((row, i) => (
                                    <tr key={i} className={`hover:bg-slate-50 ${row.change > 4000 ? 'bg-emerald-50' : ''}`}>
                                    <td className="px-6 py-4 font-medium text-slate-900">
                                        G{row.grade} - {row.role}
                                    </td>
                                    <td className="px-6 py-4 text-slate-500">{row.current}</td>
                                    <td className="px-6 py-4 font-bold text-slate-900">{row.proposed}</td>
                                    <td className="px-6 py-4 text-right">
                                        {row.change > 0 ? (
                                        <span className="text-emerald-600 font-medium">+{row.change.toLocaleString()}</span>
                                        ) : (
                                        <span className="text-slate-400">-</span>
                                        )}
                                    </td>
                                    </tr>
                                ))}
                                </tbody>
                            </table>
                            </div>
                        </Card>

                        {/* New Market Data Section */}
                         <Card className="p-0">
                            <div className="bg-slate-50 px-6 py-4 border-b border-slate-200 font-semibold text-slate-700 flex justify-between items-center">
                                <div className="flex items-center gap-2">
                                    <Info size={18} className="text-blue-500"/>
                                    <span>Market Benchmark: 50 Mbps Internet</span>
                                </div>
                                <span className="text-xs font-normal bg-blue-100 text-blue-700 px-2 py-1 rounded">Tax-Inclusive (1.33x)</span>
                            </div>
                            <div className="p-4">
                                <p className="text-sm text-slate-600 mb-4">
                                    A market survey of major ISPs confirms that a standard 50 Mbps connection costs significantly more than current allowances for mid-level staff (PkR 4,500-5,000).
                                </p>
                                <div className="overflow-x-auto">
                                    <table className="w-full text-sm text-left">
                                        <thead className="bg-slate-50 text-slate-500 font-medium">
                                            <tr>
                                                <th className="px-4 py-2">Provider</th>
                                                <th className="px-4 py-2">Speed</th>
                                                <th className="px-4 py-2 text-right">Base Price</th>
                                                <th className="px-4 py-2 text-right">Total (Inc. Tax)</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-slate-100">
                                            {internetMarketData.map((item, i) => (
                                                <tr key={i}>
                                                    <td className="px-4 py-2 font-medium text-slate-700">{item.provider}</td>
                                                    <td className="px-4 py-2 text-slate-500">{item.speed}</td>
                                                    <td className="px-4 py-2 text-right text-slate-500">{formatCurrency(item.base)}</td>
                                                    <td className="px-4 py-2 text-right font-bold text-slate-800">{formatCurrency(item.total)}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </Card>
                    </div>

                    <div className="space-y-6">
                    <Card className="p-6">
                        <h3 className="font-semibold text-slate-900 mb-4">Rationale: The "Tax-Inclusive" Gap</h3>
                        <div className="space-y-4">
                        <div className="bg-slate-50 p-3 rounded border border-slate-200">
                            <div className="text-xs text-slate-500 uppercase tracking-wide">Market Reality</div>
                            <div className="mt-1 text-sm text-slate-700">
                            Advertised rates exclude taxes. Real cost is <strong>~1.33x</strong> higher.
                            </div>
                        </div>
                        <div className="relative pt-4">
                            <div className="flex justify-between text-xs mb-1">
                            <span>Base Package</span>
                            <span className="font-bold">PKR 5,400 (Avg)</span>
                            </div>
                            <div className="flex justify-between text-xs mb-1 text-red-600">
                            <span>Taxes (Sales + Advance)</span>
                            <span className="font-bold">+ PKR 1,800</span>
                            </div>
                            <div className="border-t border-slate-200 pt-1 mt-1 flex justify-between text-sm font-bold text-slate-900">
                            <span>Total Bill</span>
                            <span>PKR 7,200</span>
                            </div>
                        </div>
                        </div>
                    </Card>

                    <Card className="p-6 bg-emerald-50 border-emerald-100">
                        <h3 className="font-semibold text-emerald-900 mb-2">Financial Impact</h3>
                        <div className="space-y-2">
                            <div className="flex justify-between text-sm">
                            <span className="text-emerald-700">Monthly Increase:</span>
                            <span className="font-bold text-emerald-900">PKR 66,375</span>
                            </div>
                            <div className="flex justify-between text-sm">
                            <span className="text-emerald-700">Annual Impact:</span>
                            <span className="font-bold text-emerald-900">PKR 796,500</span>
                            </div>
                        </div>
                    </Card>
                    </div>
                </div>
                </div>
            );

            const renderAgenda4 = () => {
                const entitlement = vehicleEntitlements.find(e => e.grade === vGrade) || { value: 0 };
                const entitlementValue = entitlement.value;
                const upgradeDelta = Math.max(0, chosenCarPrice - entitlementValue);
                const upgradeContribution = upgradeDelta * 0.8;
                const standardBuyback = chosenCarPrice * 0.2;
                
                const prvPercent = Math.max(0.2, 1 - 0.8 * (earlyExitMonths / 60));
                const prvValue = chosenCarPrice * prvPercent;

                return (
                <div className="space-y-6">
                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                        <h2 className="text-2xl font-bold text-slate-900">Agenda 4: Employee Vehicle Policy</h2>
                        <p className="text-slate-500">Standardized company-owned vehicle framework with buyback options.</p>
                    </div>
                    <Badge color="purple">New Policy</Badge>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        {/* Card 1: Tax Efficiency */}
                        <Card className="p-4 bg-purple-50 border-purple-100">
                            <div className="flex items-center gap-3 mb-2">
                                <DollarSign className="text-purple-600" size={20} />
                                <h3 className="font-semibold text-purple-900">Tax Efficiency</h3>
                            </div>
                            <p className="text-sm text-purple-800">Optimized structure that is tax efficient for both the employee and NCGCL.</p>
                        </Card>

                        {/* Card 2: Cost Reduction */}
                        <Card className="p-4 bg-purple-50 border-purple-100">
                             <div className="flex items-center gap-3 mb-2">
                                <TrendingUp className="text-purple-600" size={20} />
                                <h3 className="font-semibold text-purple-900">Cost Control (2027+)</h3>
                            </div>
                            <p className="text-sm text-purple-800">Reduces future payroll volatility as inflation/car value adjustments won't apply to monetization.</p>
                        </Card>

                        {/* Card 3: Company Owned */}
                        <Card className="p-4 bg-purple-50 border-purple-100">
                            <div className="flex items-center gap-3 mb-2">
                                <Car className="text-purple-600" size={20} />
                                <h3 className="font-semibold text-purple-900">Company Owned</h3>
                            </div>
                            <p className="text-sm text-purple-800">Vehicles are NCGCL assets. Standardized framework replacing cash allowances.</p>
                        </Card>

                        {/* Card 4: Upgrade Option */}
                        <Card className="p-4 bg-purple-50 border-purple-100">
                            <div className="flex items-center gap-3 mb-2">
                                <DollarSign className="text-purple-600" size={20} />
                                <h3 className="font-semibold text-purple-900">Upgrade Option</h3>
                            </div>
                            <p className="text-sm text-purple-800">Employees can choose a car above entitlement by paying 80% of the delta upfront.</p>
                        </Card>

                        {/* Card 5: Buyback */}
                        <Card className="p-4 bg-purple-50 border-purple-100">
                            <div className="flex items-center gap-3 mb-2">
                                <CheckCircle className="text-purple-600" size={20} />
                                <h3 className="font-semibold text-purple-900">Buyback @ 20%</h3>
                            </div>
                            <p className="text-sm text-purple-800">Standard 5-year cycle. Employee can buy car at 20% of original cost at end of term.</p>
                        </Card>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <Card className="p-0 border-t-4 border-t-blue-500">
                        <div className="bg-slate-50 px-6 py-4 border-b border-slate-200 font-bold text-slate-700 flex items-center gap-2">
                            <Calculator size={18} />
                            Vehicle Cost Modeler
                        </div>
                        <div className="p-6 space-y-6">
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-xs font-medium text-slate-500 mb-1">Select Grade</label>
                                    <select 
                                        value={vGrade} 
                                        onChange={(e) => setVGrade(e.target.value)}
                                        className="w-full p-2 border border-slate-300 rounded-md text-sm"
                                    >
                                        {vehicleEntitlements.map(e => (
                                            <option key={e.grade} value={e.grade}>Grade {e.grade}</option>
                                        ))}
                                    </select>
                                    <div className="mt-1 text-xs text-blue-600 font-medium">Entitlement: {formatCurrency(entitlementValue)}</div>
                                </div>
                                <div>
                                    <label className="block text-xs font-medium text-slate-500 mb-1">Chosen Car Price (PKR)</label>
                                    <input 
                                        type="number" 
                                        value={chosenCarPrice}
                                        onChange={(e) => setChosenCarPrice(Number(e.target.value))}
                                        className="w-full p-2 border border-slate-300 rounded-md text-sm"
                                    />
                                </div>
                            </div>

                            <div className="bg-slate-50 rounded-lg p-4 space-y-3">
                                <div className="flex justify-between text-sm">
                                    <span className="text-slate-600">Upgrade Amount (Delta):</span>
                                    <span className="font-medium">{formatCurrency(upgradeDelta)}</span>
                                </div>
                                <div className="flex justify-between text-sm">
                                    <span className="text-slate-600">Employee Contribution (80%):</span>
                                    <span className="font-bold text-red-600">-{formatCurrency(upgradeContribution)}</span>
                                </div>
                                <div className="border-t border-slate-200 my-2"></div>
                                <div className="flex justify-between text-sm">
                                    <span className="text-slate-600">End of Cycle Buyback (20%):</span>
                                    <span className="font-bold text-emerald-600">{formatCurrency(standardBuyback)}</span>
                                </div>
                            </div>
                        </div>
                    </Card>

                    <Card className="p-0 border-t-4 border-t-orange-500">
                        <div className="bg-slate-50 px-6 py-4 border-b border-slate-200 font-bold text-slate-700 flex items-center gap-2">
                            <AlertCircle size={18} />
                            Early Separation Buyback Estimator
                        </div>
                        <div className="p-6 space-y-6">
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-xs font-medium text-slate-500 mb-1">Months Served</label>
                                    <input 
                                        type="range" min="1" max="60" 
                                        value={earlyExitMonths}
                                        onChange={(e) => setEarlyExitMonths(Number(e.target.value))}
                                        className="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer"
                                    />
                                    <div className="text-center text-sm font-bold mt-1">{earlyExitMonths} Months</div>
                                </div>
                                <div>
                                    <div className="text-xs text-slate-500 mb-1">Buyback Formula</div>
                                    <div className="text-xs italic text-slate-600">Max(20%, 100% - 80% * (m/60))</div>
                                </div>
                            </div>

                            <div className="bg-orange-50 rounded-lg p-4 text-center">
                                <div className="text-sm text-orange-800 mb-1">Policy Residual Value (PRV)</div>
                                <div className="text-3xl font-bold text-orange-900">{formatCurrency(prvValue)}</div>
                                <div className="text-xs text-orange-700 mt-1">({(prvPercent * 100).toFixed(1)}% of original price)</div>
                            </div>
                            <p className="text-xs text-slate-400 text-center">Note: Actual price is Higher of PRV or Fair Market Value.</p>
                        </div>
                    </Card>
                    </div>
                </div>
                );
            };

            const renderAgenda5 = () => {
                const multiplier = fyraMultipliers[fyraGrade] || 0.9;
                const perfFactor = performanceOverlay[perfRating] || 1.0;
                const proration = Math.min(1, serviceMonths / 12);
                
                const annualBaseNum = Number(annualBase);
                const weightedBaseIndividual = annualBaseNum * proration * multiplier;
                const estimatedAward = weightedBaseIndividual * hypotheticalCTAR * perfFactor;
                const monthlySalary = annualBaseNum / 12;
                const capAmount = monthlySalary * 2 * proration; 
                const finalAward = Math.min(estimatedAward, capAmount);

                return (
                <div className="space-y-6">
                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                        <h2 className="text-2xl font-bold text-slate-900">Agenda 5: Founding-Year Recognition Award (FYRA)</h2>
                        <p className="text-slate-500">One-time award linked to payroll savings (Self-funded).</p>
                    </div>
                    <Badge color="amber">One-Time</Badge>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <Card className="p-6 bg-slate-800 text-white col-span-1 md:col-span-2 relative overflow-hidden">
                            <div className="relative z-10">
                                <h3 className="text-slate-300 font-medium mb-1">Total Pool Cap</h3>
                                <div className="text-4xl font-bold mb-4">PKR 11.2 Million</div>
                                <div className="flex gap-8 text-sm">
                                    <div>
                                        <span className="block text-slate-400 text-xs">Budgeted Payroll</span>
                                        <span className="font-semibold">PKR 113.33M</span>
                                    </div>
                                    <div>
                                        <span className="block text-slate-400 text-xs">Actual Payroll</span>
                                        <span className="font-semibold">PKR 81.3M</span>
                                    </div>
                                    <div>
                                        <span className="block text-slate-400 text-xs">Pool Share</span>
                                        <span className="font-semibold text-amber-400">35% of Savings</span>
                                    </div>
                                </div>
                            </div>
                            <div className="absolute -right-5 -bottom-5 text-slate-700 opacity-50"><Award size={140} /></div>
                        </Card>

                        <Card className="p-6 bg-amber-50 border-amber-100">
                            <h3 className="font-semibold text-amber-900 mb-2">Award Principles</h3>
                            <ul className="space-y-2 text-sm text-amber-800">
                                <li className="flex gap-2"><CheckCircle size={16} /> Non-pensionable one-off payment.</li>
                                <li className="flex gap-2"><CheckCircle size={16} /> Prorated by service months (from Jan '25).</li>
                                <li className="flex gap-2"><CheckCircle size={16} /> Capped at 2x Monthly Basic Salary.</li>
                            </ul>
                        </Card>
                    </div>

                    <Card className="p-0">
                        <div className="bg-slate-50 px-6 py-4 border-b border-slate-200 font-bold text-slate-700 flex items-center gap-2">
                            <Calculator size={18} />
                            Individual Award Simulator
                        </div>
                        <div className="p-6 grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-xs font-medium text-slate-500 mb-1">Grade</label>
                                    <select value={fyraGrade} onChange={(e) => setFyraGrade(e.target.value)} className="w-full p-2 border rounded text-sm">
                                        {Object.keys(fyraMultipliers).map(k => <option key={k} value={k}>Grade {k}</option>)}
                                    </select>
                                    <div className="text-xs text-amber-600 mt-1">Multiplier: x{multiplier.toFixed(2)}</div>
                                </div>
                                <div>
                                    <label className="block text-xs font-medium text-slate-500 mb-1">Annual Base Salary (PKR)</label>
                                    <input type="number" value={annualBase} onChange={(e) => setAnnualBase(e.target.value)} className="w-full p-2 border rounded text-sm" />
                                </div>
                                <div>
                                    <label className="block text-xs font-medium text-slate-500 mb-1">Service Months (in 2025)</label>
                                    <input type="range" min="3" max="12" value={serviceMonths} onChange={(e) => setServiceMonths(Number(e.target.value))} className="w-full" />
                                    <div className="text-xs text-right">{serviceMonths} Months (Proration: {proration.toFixed(2)})</div>
                                </div>
                                <div>
                                    <label className="block text-xs font-medium text-slate-500 mb-1">Performance Rating</label>
                                    <div className="flex gap-2">
                                        {Object.keys(performanceOverlay).map(p => (
                                            <button 
                                                key={p} 
                                                onClick={() => setPerfRating(p)}
                                                className={`flex-1 py-2 text-xs rounded border ${perfRating === p ? 'bg-amber-500 text-white border-amber-600' : 'bg-white border-slate-300'}`}
                                            >
                                                {p}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            <div className="bg-slate-50 rounded-xl p-6 flex flex-col justify-center space-y-4">
                                <div className="flex justify-between items-center text-sm">
                                    <span className="text-slate-600">Calculated Uncapped Award:</span>
                                    <span className="font-medium text-slate-400">{formatCurrency(estimatedAward)}</span>
                                </div>
                                <div className="flex justify-between items-center text-sm">
                                    <span className="text-slate-600">Cap Limit (2x Monthly):</span>
                                    <span className="font-medium text-slate-400">{formatCurrency(capAmount)}</span>
                                </div>
                                
                                <div className="border-t border-slate-200 pt-4">
                                    <div className="text-center">
                                        <span className="text-sm text-slate-500 block mb-1">Estimated FYRA Payout</span>
                                        <span className="text-4xl font-bold text-amber-600">{formatCurrency(finalAward)}</span>
                                    </div>
                                    {finalAward === capAmount && (
                                        <div className="text-center text-xs text-red-500 mt-2 font-medium flex items-center justify-center gap-1">
                                            <AlertCircle size={12} /> Capped at 2x Monthly Basic
                                        </div>
                                    )}
                                </div>

                                <div className="bg-blue-50 p-3 rounded text-xs text-blue-700 leading-relaxed">
                                    <strong>Note:</strong> This simulation uses a hypothetical distribution rate (CTAR). Actual payout depends on the total Weighted Base of all eligible employees.
                                </div>
                            </div>
                        </div>
                    </Card>
                </div>
                );
            };

            return (
                <div className="min-h-screen bg-slate-100 flex">
                {/* Sidebar - Fixed Position */}
                <div className={`${isSidebarOpen ? 'w-64' : 'w-20'} bg-white border-r border-slate-200 transition-all duration-300 flex-shrink-0 flex flex-col h-screen fixed top-0 left-0 z-20`}>
                    <div className="p-4 border-b border-slate-100 flex items-center justify-between">
                        {isSidebarOpen ? <span className="font-bold text-lg text-slate-800 tracking-tight">NCGCL Board</span> : <span className="font-bold text-xl mx-auto">N</span>}
                        <button onClick={() => setSidebarOpen(!isSidebarOpen)} className="p-1 hover:bg-slate-100 rounded text-slate-500">
                            <ChevronRight size={20} className={`transition-transform ${isSidebarOpen ? 'rotate-180' : ''}`} />
                        </button>
                    </div>
                    
                    <nav className="flex-1 py-4 space-y-1">
                    <NavItem id="home" label={isSidebarOpen ? "Dashboard Home" : ""} icon={Users} color="slate" />
                    <NavItem id="agenda2" label={isSidebarOpen ? "Agenda 2: Car Monet." : ""} icon={Car} color="blue" />
                    <NavItem id="agenda3" label={isSidebarOpen ? "Agenda 3: Comm." : ""} icon={Wifi} color="emerald" />
                    <NavItem id="agenda4" label={isSidebarOpen ? "Agenda 4: Vehicle" : ""} icon={FileText} color="purple" />
                    <NavItem id="agenda5" label={isSidebarOpen ? "Agenda 5: FYRA" : ""} icon={Award} color="amber" />
                    </nav>

                    <div className="p-4 border-t border-slate-100">
                        {isSidebarOpen && <div className="text-xs text-slate-400">Meeting Date: Dec 2025</div>}
                    </div>
                </div>

                {/* Main Content */}
                <main className={`flex-1 p-4 md:p-8 ${isSidebarOpen ? 'ml-64' : 'ml-20'} transition-all min-h-screen`}>
                    <div className="max-w-6xl mx-auto">
                        {activeTab === "home" && renderHome()}
                        {activeTab === "agenda2" && renderAgenda2()}
                        {activeTab === "agenda3" && renderAgenda3()}
                        {activeTab === "agenda4" && renderAgenda4()}
                        {activeTab === "agenda5" && renderAgenda5()}
                    </div>
                </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<BoardDashboard />);
    </script>
</body>
</html>
