<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Compounding Growth Analyzer (HTML + JS)</title>

  <!-- Tailwind via CDN (good enough for GitHub Pages / offline viewing) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js for the chart (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    /* Minor: keep number inputs readable across browsers */
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    input[type="number"] { -moz-appearance: textfield; }
  </style>
</head>

<body class="min-h-screen bg-slate-50 p-4 md:p-8 font-sans text-slate-900">
  <div class="max-w-7xl mx-auto space-y-6">

    <!-- Header -->
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
      <div>
        <h1 class="text-3xl font-bold text-slate-900 flex items-center gap-3">
          <!-- simple inline icon -->
          <svg class="w-7 h-7 text-indigo-600" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M3 17l6-6 4 4 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 7v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Compounding Growth Analyzer
        </h1>
        <p class="text-slate-600 mt-1">Comparing Bank Deposits vs. Mutual Funds tax efficiency</p>
      </div>

      <div class="flex items-center gap-2 text-sm text-slate-500 bg-white px-4 py-2 rounded-full shadow-sm border border-slate-200">
        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
          <path d="M12 16v-5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <path d="M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span>Scenario: <span id="durationBadge">12</span> Month Investment Term</span>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">

      <!-- Controls Sidebar -->
      <div class="lg:col-span-3 space-y-6">
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-5">
          <h3 class="font-semibold text-slate-900 mb-4 flex items-center gap-2">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M3 3h18v6H3z" stroke="currentColor" stroke-width="2"/>
              <path d="M7 13h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <path d="M7 17h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <path d="M6 21h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Configuration
          </h3>

          <!-- Inputs -->
          <div class="mb-4">
            <label class="block text-sm font-medium text-slate-700 mb-1">Principal Amount</label>
            <input id="principal" type="number" min="1000" step="10000"
              class="block w-full rounded-md border-slate-300 py-2 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm border px-3"
              value="1000000000"/>
          </div>

          <div class="mb-4">
            <label class="block text-sm font-medium text-slate-700 mb-1">Duration (Months)</label>
            <div class="relative rounded-md shadow-sm">
              <input id="durationMonths" type="number" min="1" step="1"
                class="block w-full rounded-md border-slate-300 py-2 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm border px-3 pr-12"
                value="12"/>
              <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3">
                <span class="text-slate-500 sm:text-sm">mo</span>
              </div>
            </div>
          </div>

          <div class="border-t border-slate-100 my-4 pt-4">
            <h4 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">Bank Parameters</h4>

            <div class="mb-4">
              <label class="block text-sm font-medium text-slate-700 mb-1">Annual Rate</label>
              <div class="relative rounded-md shadow-sm">
                <input id="bankRate" type="number" min="0" step="0.1"
                  class="block w-full rounded-md border-slate-300 py-2 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm border px-3 pr-12"
                  value="10"/>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3">
                  <span class="text-slate-500 sm:text-sm">%</span>
                </div>
              </div>
            </div>

            <div class="mb-4">
              <label class="block text-sm font-medium text-slate-700 mb-1">WHT (Monthly Tax)</label>
              <div class="relative rounded-md shadow-sm">
                <input id="bankTaxRate" type="number" min="0" step="0.1"
                  class="block w-full rounded-md border-slate-300 py-2 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm border px-3 pr-12"
                  value="29"/>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3">
                  <span class="text-slate-500 sm:text-sm">%</span>
                </div>
              </div>
            </div>
          </div>

          <div class="border-t border-slate-100 my-4 pt-4">
            <h4 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">Mutual Fund Parameters</h4>

            <div class="mb-4">
              <label class="block text-sm font-medium text-slate-700 mb-1">Annual Rate</label>
              <div class="relative rounded-md shadow-sm">
                <input id="mfRate" type="number" min="0" step="0.1"
                  class="block w-full rounded-md border-slate-300 py-2 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm border px-3 pr-12"
                  value="10"/>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3">
                  <span class="text-slate-500 sm:text-sm">%</span>
                </div>
              </div>
            </div>

            <div class="mb-4">
              <label class="block text-sm font-medium text-slate-700 mb-1">CGT (End of Term)</label>
              <div class="relative rounded-md shadow-sm">
                <input id="mfTaxRate" type="number" min="0" step="0.1"
                  class="block w-full rounded-md border-slate-300 py-2 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm border px-3 pr-12"
                  value="15"/>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3">
                  <span class="text-slate-500 sm:text-sm">%</span>
                </div>
              </div>
            </div>
          </div>

          <div class="border-t border-slate-100 my-4 pt-4">
            <h4 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">Global Taxes</h4>

            <div class="mb-0">
              <label class="block text-sm font-medium text-slate-700 mb-1">Super Tax (on Gain)</label>
              <div class="relative rounded-md shadow-sm">
                <input id="superTaxRate" type="number" min="0" step="0.1"
                  class="block w-full rounded-md border-slate-300 py-2 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm border px-3 pr-12"
                  value="10"/>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3">
                  <span class="text-slate-500 sm:text-sm">%</span>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div class="bg-indigo-50 rounded-xl p-4 border border-indigo-100">
          <div class="flex gap-2 items-start text-indigo-800">
            <svg class="w-5 h-5 mt-0.5 shrink-0" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <path d="M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <path d="M11 12h1v4h1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <p class="text-xs leading-relaxed">
              <strong>Insight:</strong> Bank deposits typically deduct tax monthly, reducing the principal available for compounding.
              Mutual funds often defer tax until redemption, allowing gross amounts to compound longer.
            </p>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="lg:col-span-9 space-y-6">

        <!-- Stats Row -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
            <p class="text-sm font-medium text-slate-500 mb-1">Bank Net Profit</p>
            <h3 class="text-2xl font-bold text-slate-900" id="bankNetProfit">0</h3>
            <p class="text-sm mt-1 text-slate-600" id="bankReturnPct">0% Return</p>
          </div>

          <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
            <p class="text-sm font-medium text-slate-500 mb-1">Mutual Fund Net Profit</p>
            <h3 class="text-2xl font-bold text-slate-900" id="mfNetProfit">0</h3>
            <p class="text-sm mt-1 text-emerald-600" id="mfReturnPct">0% Return</p>
          </div>

          <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
            <p class="text-sm font-medium text-slate-500 mb-1">Difference</p>
            <h3 class="text-2xl font-bold text-slate-900" id="difference">0</h3>
            <p class="text-sm mt-1 text-indigo-600">Additional Gain</p>
          </div>
        </div>

        <!-- Chart Area -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
          <div class="flex items-center justify-between mb-6">
            <h3 class="font-bold text-slate-800">Portfolio Growth Trajectory</h3>
            <div class="flex gap-4 text-sm">
              <div class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full bg-slate-400"></span>
                <span>Bank Deposit</span>
              </div>
              <div class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full bg-emerald-500"></span>
                <span>Mutual Fund</span>
              </div>
            </div>
          </div>

          <div class="h-[400px] w-full">
            <canvas id="growthChart"></canvas>
          </div>
        </div>

        <!-- Detailed Breakdown -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

          <!-- Bank -->
          <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
            <div class="bg-slate-50 p-4 border-b border-slate-200">
              <h4 class="font-semibold text-slate-700">Bank Breakdown</h4>
            </div>
            <div class="p-4 space-y-3">
              <div class="flex justify-between text-sm">
                <span class="text-slate-500">Gross Interest Earned</span>
                <span class="font-medium" id="bankGrossInterest">0</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-slate-500">Monthly Tax Deducted (Approx)</span>
                <span class="text-red-500" id="bankMonthlyTax">-0</span>
              </div>
              <div class="flex justify-between text-sm border-t border-slate-100 pt-2">
                <span class="text-slate-500">Net Before Super Tax</span>
                <span class="font-medium" id="bankNetBeforeSuper">0</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-slate-500">Super Tax (<span id="superTaxLabel1">10</span>%)</span>
                <span class="text-red-500" id="bankSuperTax">-0</span>
              </div>
              <div class="flex justify-between text-base font-bold bg-slate-50 p-2 rounded border border-slate-100">
                <span class="text-slate-700">Net Profit</span>
                <span class="text-slate-900" id="bankNetProfitDetail">0</span>
              </div>
            </div>
          </div>

          <!-- MF -->
          <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
            <div class="bg-emerald-50 p-4 border-b border-emerald-100">
              <h4 class="font-semibold text-emerald-800">Mutual Fund Breakdown</h4>
            </div>
            <div class="p-4 space-y-3">
              <div class="flex justify-between text-sm">
                <span class="text-slate-500">Gross Gain</span>
                <span class="font-medium" id="mfGrossGain">0</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-slate-500">Tax Deferred Compounding</span>
                <span class="text-emerald-600 font-medium">Active</span>
              </div>
              <div class="flex justify-between text-sm border-t border-slate-100 pt-2">
                <span class="text-slate-500">Capital Gains Tax (<span id="mfTaxLabel">15</span>%)</span>
                <span class="text-red-500" id="mfTax">-0</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-slate-500">Super Tax (<span id="superTaxLabel2">10</span>%)</span>
                <span class="text-red-500" id="mfSuperTax">-0</span>
              </div>
              <div class="flex justify-between text-base font-bold bg-slate-50 p-2 rounded border border-slate-100">
                <span class="text-slate-700">Net Profit</span>
                <span class="text-emerald-700" id="mfNetProfitDetail">0</span>
              </div>
            </div>
          </div>

        </div>

      </div>
    </div>
  </div>

<script>
  // ---------------------------
  // Utilities
  // ---------------------------
  function toNumber(v, fallback = 0) {
    const n = Number(v);
    return Number.isFinite(n) ? n : fallback;
  }

  function formatCurrencyCompact(val) {
    const n = Number(val) || 0;
    if (n === 0) return "0";
    if (Math.abs(n) >= 1e9) return (n / 1e9).toFixed(2) + "B";
    if (Math.abs(n) >= 1e6) return (n / 1e6).toFixed(2) + "M";
    return n.toLocaleString("en-US", { maximumFractionDigits: 0 });
  }

  function formatNumber0(val) {
    const n = Number(val) || 0;
    return new Intl.NumberFormat("en-US", { maximumFractionDigits: 0 }).format(n);
  }

  // ---------------------------
  // Core calculation (mirrors your React logic)
  // ---------------------------
  function computeProjection(inputs) {
    const safePrincipal = inputs.principal || 0;

    let bankBalance = safePrincipal;
    let mfBalance = safePrincipal;

    const chartData = [];

    for (let month = 0; month <= inputs.durationMonths; month++) {
      if (month === 0) {
        chartData.push({
          month,
          name: "Start",
          Bank: Math.round(bankBalance),
          MutualFund: Math.round(mfBalance),
          BankGain: 0,
          MFGain: 0,
        });
        continue;
      }

      // Bank: interest taxed monthly
      const bankMonthlyRate = inputs.bankRate / 100 / 12;
      const bankInterest = bankBalance * bankMonthlyRate;
      const bankTax = bankInterest * (inputs.bankTaxRate / 100);
      bankBalance = bankBalance + bankInterest - bankTax;

      // MF: gross compounding, taxes at end
      const mfMonthlyRate = inputs.mfRate / 100 / 12;
      const mfGain = mfBalance * mfMonthlyRate;
      mfBalance = mfBalance + mfGain;

      chartData.push({
        month,
        name: `M${month}`,
        Bank: Math.round(bankBalance),
        MutualFund: Math.round(mfBalance),
        BankGain: Math.round(bankBalance - safePrincipal),
        MFGain: Math.round(mfBalance - safePrincipal),
      });
    }

    return { chartData, finalBank: bankBalance, finalMF: mfBalance };
  }

  function computeResults(inputs, projection) {
    const safePrincipal = inputs.principal || 0;

    const totalBankGain = projection.finalBank - safePrincipal;
    const totalMFGainGross = projection.finalMF - safePrincipal;

    // Bank super tax at end (on gain)
    const bankSuperTax = totalBankGain * (inputs.superTaxRate / 100);
    const bankNetFinish = projection.finalBank - bankSuperTax;

    // MF: CGT + super tax at end (on gain)
    const mfTax = totalMFGainGross * (inputs.mfTaxRate / 100);
    const mfSuperTax = totalMFGainGross * (inputs.superTaxRate / 100);
    const mfNetFinish = projection.finalMF - mfTax - mfSuperTax;

    // Approx "gross equivalent" and "monthly tax paid" display logic from your React code
    const bankTaxDenominator = 1 - inputs.bankTaxRate / 100;
    const bankGrossEquivalent = bankTaxDenominator !== 0 ? (totalBankGain / bankTaxDenominator) : 0;
    const bankMonthlyTaxPaid = bankGrossEquivalent - totalBankGain;

    return {
      bank: {
        gross: projection.finalBank,
        gain: totalBankGain,
        superTax: bankSuperTax,
        net: bankNetFinish,
        // totalTax kept conceptually similar to your original display
        totalTax: (projection.finalBank - bankNetFinish) + bankMonthlyTaxPaid,
        monthlyTaxPaid: bankMonthlyTaxPaid,
        grossInterest: bankGrossEquivalent
      },
      mf: {
        gross: projection.finalMF,
        gain: totalMFGainGross,
        tax: mfTax,
        superTax: mfSuperTax,
        net: mfNetFinish
      }
    };
  }

  // ---------------------------
  // Chart
  // ---------------------------
  let chart;

  function initChart() {
    const ctx = document.getElementById("growthChart").getContext("2d");
    chart = new Chart(ctx, {
      type: "line",
      data: {
        labels: [],
        datasets: [
          { label: "Bank Deposit", data: [], tension: 0.25, pointRadius: 0, borderWidth: 2 },
          { label: "Mutual Fund", data: [], tension: 0.25, pointRadius: 0, borderWidth: 2 }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        interaction: { mode: "index", intersect: false },
        plugins: {
          legend: { display: false }, // you already show manual legend labels
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${formatNumber0(ctx.parsed.y)}`
            }
          }
        },
        scales: {
          y: {
            ticks: {
              callback: (v) => (v / 1e6).toFixed(1) + "M"
            },
            grid: { color: "#f1f5f9" }
          },
          x: {
            grid: { display: false }
          }
        }
      }
    });
  }

  function updateChart(chartData) {
    const labels = chartData.map(d => d.name);
    const bank = chartData.map(d => d.Bank);
    const mf = chartData.map(d => d.MutualFund);

    chart.data.labels = labels;
    chart.data.datasets[0].data = bank;
    chart.data.datasets[1].data = mf;
    chart.update();
  }

  // ---------------------------
  // DOM update
  // ---------------------------
  function readInputs() {
    return {
      principal: toNumber(document.getElementById("principal").value, 0),
      durationMonths: Math.max(1, Math.floor(toNumber(document.getElementById("durationMonths").value, 12))),
      bankRate: toNumber(document.getElementById("bankRate").value, 0),
      mfRate: toNumber(document.getElementById("mfRate").value, 0),
      bankTaxRate: toNumber(document.getElementById("bankTaxRate").value, 0),
      mfTaxRate: toNumber(document.getElementById("mfTaxRate").value, 0),
      superTaxRate: toNumber(document.getElementById("superTaxRate").value, 0),
    };
  }

  function render() {
    const inputs = readInputs();

    // Keep badge / labels in sync
    document.getElementById("durationBadge").textContent = inputs.durationMonths;
    document.getElementById("superTaxLabel1").textContent = inputs.superTaxRate;
    document.getElementById("superTaxLabel2").textContent = inputs.superTaxRate;
    document.getElementById("mfTaxLabel").textContent = inputs.mfTaxRate;

    const projection = computeProjection(inputs);
    const results = computeResults(inputs, projection);

    // KPI Cards
    const bankNetProfit = results.bank.net - inputs.principal;
    const mfNetProfit = results.mf.net - inputs.principal;

    document.getElementById("bankNetProfit").textContent = formatCurrencyCompact(bankNetProfit);
    document.getElementById("mfNetProfit").textContent = formatCurrencyCompact(mfNetProfit);
    document.getElementById("difference").textContent = formatCurrencyCompact(results.mf.net - results.bank.net);

    const bankPct = inputs.principal > 0 ? (bankNetProfit / inputs.principal * 100) : 0;
    const mfPct = inputs.principal > 0 ? (mfNetProfit / inputs.principal * 100) : 0;

    document.getElementById("bankReturnPct").textContent = `${bankPct.toFixed(2)}% Return`;
    document.getElementById("mfReturnPct").textContent = `${mfPct.toFixed(2)}% Return`;

    // Breakdown: Bank
    document.getElementById("bankGrossInterest").textContent = formatNumber0(results.bank.grossInterest);
    document.getElementById("bankMonthlyTax").textContent = `-${formatNumber0(results.bank.monthlyTaxPaid)}`;
    document.getElementById("bankNetBeforeSuper").textContent = formatNumber0(results.bank.gain);
    document.getElementById("bankSuperTax").textContent = `-${formatNumber0(results.bank.superTax)}`;
    document.getElementById("bankNetProfitDetail").textContent = formatNumber0(bankNetProfit);

    // Breakdown: MF
    document.getElementById("mfGrossGain").textContent = formatNumber0(results.mf.gain);
    document.getElementById("mfTax").textContent = `-${formatNumber0(results.mf.tax)}`;
    document.getElementById("mfSuperTax").textContent = `-${formatNumber0(results.mf.superTax)}`;
    document.getElementById("mfNetProfitDetail").textContent = formatNumber0(mfNetProfit);

    // Chart
    updateChart(projection.chartData);
  }

  function attachListeners() {
    const ids = [
      "principal",
      "durationMonths",
      "bankRate",
      "bankTaxRate",
      "mfRate",
      "mfTaxRate",
      "superTaxRate"
    ];

    ids.forEach(id => {
      const el = document.getElementById(id);
      el.addEventListener("input", render);
      el.addEventListener("change", render);
      el.addEventListener("focus", (e) => e.target.select());
    });
  }

  // Boot
  initChart();
  attachListeners();
  render();
</script>
</body>
</html>
